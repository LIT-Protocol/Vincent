---
title: Development and Testing
---

Learn how to test your Vincent abilities locally before deploying to production.

<Warning>
**Prerequisites:** This guide builds on the [Quick Start](/app/quickstart) guide. Complete the Quick Start setup before proceeding.
</Warning>

## Step 1: Create Your Test Execution Script

Create a file called `test-execution.ts` in your project. This script will import the setup function from your Quick Start script and test ability execution.

<Warning>
**Important:** The code below uses the Aerodrome Swap ability as an example. You must replace the following to match your chosen ability:

1. **`.env` file path** - Update `config({ path: ... })` to point to your `.env` file location
2. **Ability import** - Replace `@lit-protocol/vincent-ability-aerodrome-swap` with your ability package
3. **Ability parameters** - Update the `precheck()` and `execute()` parameters to match your ability's requirements

Look for `TODO` comments in the code to locate these sections.
</Warning>

```typescript
import { config } from '@dotenvx/dotenvx';
import { resolve } from 'path';

// Load environment variables from .env file in the same directory
config({ path: resolve(__dirname, '../.env'), override: false });

import {
  funder,
  delegatee,
  ensureUnexpiredCapacityToken,
} from '@lit-protocol/vincent-e2e-test-utils';
import {
  getVincentAbilityClient,
  disconnectVincentAbilityClients,
} from '@lit-protocol/vincent-app-sdk/abilityClient';
import * as util from 'node:util';
import { ethers } from 'ethers';

// Import your bundled ability
import { bundledVincentAbility } from '@lit-protocol/vincent-ability-evm-transaction-signer';

// Import setup function from your Quick Start script
import { setupVincentDevelopmentEnvironment } from './vincent-app-setup';

(async () => {
  try {
    console.log('üöÄ Starting ability execution...\n');

    // Setup and funding
    console.log('üí∞ Checking balances and funding accounts...');
    await funder.checkFunderBalance();
    await delegatee.ensureAppDelegateeFunded();

    // Run the setup from vincent-app-setup.ts
    console.log('üîß Setting up Vincent development environment...');
    const { agentPkpInfo, wallets } = await setupVincentDevelopmentEnvironment();

    await ensureUnexpiredCapacityToken(wallets.appDelegatee);
    console.log('‚úÖ All accounts funded and capacity token validated\n');

    // TODO: Create ability client with your bundled ability
    const abilityClient = getVincentAbilityClient({
      bundledVincentAbility: bundledVincentAbility,
      ethersSigner: wallets.appDelegatee,
    });

    // Create and serialize a sample transaction (ERC20 transfer of USDC)
    // Note: This transaction won't be submitted, so we use example values
    console.log('üìù Creating transaction...');

    const serializedTx = ethers.utils.serializeTransaction({
      to: '0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913', // USDC on Base
      value: '0x00',
      data: new ethers.utils.Interface([
        'function transfer(address to, uint256 amount) returns (bool)',
      ]).encodeFunctionData('transfer', [
        '0x4200000000000000000000000000000000000006', // Recipient (WETH contract as example)
        '100000', // 0.1 USDC (6 decimals)
      ]),
      chainId: 8453, // Base mainnet
      nonce: 0, // Example nonce
      gasPrice: '0x3B9ACA00', // Example: 1 gwei
      gasLimit: '0x186A0', // 100,000 gas
    });

    // Run precheck
    console.log('\nüîç Running precheck...');
    const precheckResult = await abilityClient.precheck(
      {
        serializedTransaction: serializedTx,
      },
      {
        delegatorPkpEthAddress: agentPkpInfo.ethAddress,
      },
    );

    console.log('Precheck result:', util.inspect(precheckResult, { depth: 10 }));

    if (!precheckResult.success) {
      console.error('‚ùå Precheck failed:');
      if (precheckResult.runtimeError) {
        console.error('  Runtime error:', precheckResult.runtimeError);
      }
      if (precheckResult.result) {
        console.error('  Result:', util.inspect(precheckResult.result, { depth: 10 }));
      }
      return;
    }

    const { deserializedUnsignedTransaction } = precheckResult.result;
    console.log('‚úÖ Precheck passed - deserialized transaction:', deserializedUnsignedTransaction);

    // Execute the ability (sign the transaction)
    console.log('\n‚ö° Executing ability (signing transaction)...');
    const executeResult = await abilityClient.execute(
      {
        serializedTransaction: serializedTx,
      },
      {
        delegatorPkpEthAddress: agentPkpInfo.ethAddress,
      },
    );

    console.log('Execution result:', util.inspect(executeResult, { depth: 10 }));

    if (!executeResult.success) {
      console.error('‚ùå Execution failed:');
      if (executeResult.runtimeError) {
        console.error('  Runtime error:', executeResult.runtimeError);
      }
      if (executeResult.result) {
        console.error('  Result:', util.inspect(executeResult.result, { depth: 10 }));
      }
      return;
    }

    const { signedTransaction, deserializedSignedTransaction } = executeResult.result;
    console.log('\nüéâ All ability executions completed successfully!');
  } catch (error) {
    console.error('‚ùå Execution failed with error:', error);
    throw error;
  } finally {
    console.log('\nüßπ Cleaning up...');
    await disconnectVincentAbilityClients();
  }
})();
```

## Step 2: Run Your Test

Execute your test script using `tsx`:

<CodeGroup>
```bash npm
npx tsx test-execution.ts
```

```bash yarn
yarn tsx test-execution.ts
```

```bash pnpm
pnpm tsx test-execution.ts
```
</CodeGroup>

The output will vary based on the abilities you're using and whether execution succeeds or fails. Successful executions will display transaction hashes and confirmation messages, while failures will show error details to help you debug.

## What's Next?

<Card title="Migrating to Production" icon="rocket" href="/app/migrating-to-production">
  Deploy your App to production environment
</Card>
