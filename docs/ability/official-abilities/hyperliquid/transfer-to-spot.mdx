---
title: Transfer USDC to Spot
---

The `transferToSpot` action enables Vincent Apps to transfer USDC from a Vincent User's HyperCore perp balance to their spot balance.

## Prerequisites

Before executing the `transferToSpot` action, the following conditions must be met:

- **Perp Balance on HyperCore**: The Vincent User Agent Wallet must have sufficient USDC in their HyperCore perp balance to cover the transfer amount.

<Info>
  To learn more about executing Vincent Abilities, see the [Executing
  Abilities](/ability/explaining-abilities) guide.
</Info>

## Executing the `precheck` Function

The `precheck` function validates some prerequisites for executing a transfer to spot, without actually performing the operation.

For the `transferToSpot` action, the `precheck` function will validate the following:

- The Vincent User Agent Wallet has sufficient USDC in their HyperCore perp balance to cover the transfer amount.

<Tabs>
  <Tab title="Parameters">
    The `precheck` function requires the following parameters:

    ```typescript
    import { HyperliquidAction } from '@lit-protocol/vincent-ability-hyperliquid';

    {
      /**
       * The action to perform (must be HyperliquidAction.TRANSFER_TO_SPOT)
       */
      action: HyperliquidAction.TRANSFER_TO_SPOT;
      /**
       * Whether to use Hyperliquid testnet (optional, defaults to false)
       */
      useTestnet?: boolean;
      /**
       * Transfer to spot parameters
       */
      transferToSpot: {
        /**
         * The amount of USDC to transfer in 6-decimal format.
         * Example: "15000000" = 15.0 USDC
         */
        amount: string;
      };
    }
    ```

  </Tab>

  <Tab title="Implementation">
    To execute `precheck`, you'll need to:

    - Create an instance of the `VincentAbilityClient` using the `getVincentAbilityClient` function (imported from `@lit-protocol/vincent-app-sdk/abilityClient`)
      - Pass in the Ability's `bundledVincentAbility` object (imported from `@lit-protocol/vincent-ability-hyperliquid`)
      - Pass in the `ethersSigner` you'll be using to sign the request to Lit with your Delegatee private key
    - Use the `VincentAbilityClient` instance to call the `precheck` function

    ```typescript
    import { getVincentAbilityClient } from '@lit-protocol/vincent-app-sdk/abilityClient';
    import { bundledVincentAbility, HyperliquidAction } from '@lit-protocol/vincent-ability-hyperliquid';
    import { ethers } from 'ethers';

    // Your delegatee signer (one of the delegatee signers for the Vincent App)
    const delegateeSigner = new ethers.Wallet('YOUR_DELEGATEE_PRIVATE_KEY', provider);

    // Create ability client
    const hyperliquidAbilityClient = getVincentAbilityClient({
      bundledVincentAbility,
      ethersSigner: delegateeSigner,
    });

    // Run precheck
    const precheckResult = await hyperliquidAbilityClient.precheck(
      {
        action: HyperliquidAction.TRANSFER_TO_SPOT,
        useTestnet: false, // Set to true for testnet
        transferToSpot: {
          amount: '15000000', // 15.0 USDC (6 decimals)
        },
      },
      {
        delegatorPkpEthAddress: '0x...', // The Vincent User's Vincent Wallet address
      },
    );

    if (precheckResult.success) {
      console.log('Transfer to spot precheck passed, ready to execute');
    } else {
      // Handle different types of failures
      if (precheckResult.runtimeError) {
        console.error('Runtime error:', precheckResult.runtimeError);
      }
      if (precheckResult.schemaValidationError) {
        console.error('Schema validation error:', precheckResult.schemaValidationError);
      }
      if (precheckResult.result) {
        console.error('Transfer to spot precheck failed:', precheckResult.result.reason);
      }
    }
    ```

  </Tab>

  <Tab title="Response">
    ### Success

    A successful `precheck` response will contain:

    ```typescript
    {
      /**
       * The action that was prechecked
       */
      action: 'transferToSpot';
      /**
       * The available USDC balance in the Vincent User's HyperCore perp account (optional)
       */
      availableBalance: string;
    }
    ```

    ### Failure

    A failure `precheck` response will contain:

    ```typescript
    {
      /**
       * The action that was prechecked
       */
      action: 'transferToSpot';
      /**
       * The reason the precheck failed, such as insufficient perp balance
       */
      reason: string;
      /**
       * The available balance of the asset in the Hyperliquid account (optional)
       */
      availableBalance?: string;
      /**
       * The required balance for the action (optional)
       */
      requiredBalance?: string;
    }
    ```

  </Tab>
</Tabs>

## Executing the `execute` Function

The `execute` function performs the actual transfer operation, moving USDC from the Vincent User's HyperCore perp balance to their spot balance.

For the `transferToSpot` action, the `execute` function will:

- Transfer the specified amount of USDC from the Vincent User Agent Wallet's HyperCore perp balance to their spot balance.
- Return the transfer result from Hyperliquid.

<Tabs>
  <Tab title="Parameters">
    The `execute` function requires the following parameters:

    ```typescript
    import { HyperliquidAction } from '@lit-protocol/vincent-ability-hyperliquid';

    {
      /**
       * The action to perform (must be HyperliquidAction.TRANSFER_TO_SPOT)
       */
      action: HyperliquidAction.TRANSFER_TO_SPOT;
      /**
       * Whether to use Hyperliquid testnet (optional, defaults to false)
       */
      useTestnet?: boolean;
      /**
       * Transfer to spot parameters
       */
      transferToSpot: {
        /**
         * The amount of USDC to transfer in 6-decimal format.
         * Example: "15000000" = 15.0 USDC
         */
        amount: string;
      };
    }
    ```

  </Tab>

  <Tab title="Implementation">
    The `execute` function can be executed using the same `VincentAbilityClient` instance as used for the `precheck` function:

    ```typescript
    const executeResult = await hyperliquidAbilityClient.execute(
      {
        action: HyperliquidAction.TRANSFER_TO_SPOT,
        useTestnet: false, // Set to true for testnet
        transferToSpot: {
          amount: '15000000', // 15.0 USDC (6 decimals)
        },
      },
      {
        delegatorPkpEthAddress: '0x...', // The Vincent User's Vincent Wallet address
      },
    );

    if (executeResult.success) {
      const { transferResult } = executeResult.result;
      console.log('Transfer to spot executed successfully:', transferResult);
    } else {
      // Handle different types of failures
      if (executeResult.runtimeError) {
        console.error('Runtime error:', executeResult.runtimeError);
      }
      if (executeResult.schemaValidationError) {
        console.error('Schema validation error:', executeResult.schemaValidationError);
      }
      if (executeResult.result) {
        console.error('Transfer to spot execution failed:', executeResult.result.reason);
      }
    }
    ```

  </Tab>

  <Tab title="Response">
    **Success Response**

    A successful `execute` response will contain:

    ```typescript
    {
      /**
       * The action that was executed
       */
      action: 'transferToSpot';
      /**
       * The transfer result from Hyperliquid request as defined by the Hyperliquid SDK: @nktkas/hyperliquid
       * https://github.com/nktkas/hyperliquid/blob/2233ce942eb50ef8850073b387b9918d3a54a10b/src/api/exchange/_base/_schemas.ts#L49-L73
       */
      transferResult: SuccessResponse;
    }
    ```

    **Failure Response**

    A failure `execute` response will contain:

    ```typescript
    {
      /**
       * The action that was executed
       */
      action: 'transferToSpot';
      /**
       * The reason the execution failed, such as insufficient perp balance
       */
      reason: string;
    }
    ```

  </Tab>
</Tabs>

## Important Considerations

<AccordionGroup>
  <Accordion title="USDC Decimal Format" icon="hashtag">
    USDC uses **6 decimals** for the transfer amount parameter. When specifying the transfer amount:
    - 15.0 USDC = `"15000000"`
    - 5.0 USDC = `"5000000"`
    - 100 USDC = `"100000000"`

  </Accordion>

<Accordion title="Transfer Direction" icon="arrow-right">
  This action transfers USDC from your **perp balance** to your **spot balance** on HyperCore. If
  you need to transfer in the opposite direction (spot to perp), use the [Transfer to
  Perp](/ability/official-abilities/hyperliquid/transfer-to-perp) action.
</Accordion>

  <Accordion title="Verifying Transfer Success" icon="check">
    After the transfer is executed, you can verify the balances changed by using a [Hyperliquid SDK](https://hyperliquid.gitbook.io/hyperliquid-docs/for-developers/api) to check the clearinghouse state (perp balance) of the sender and the spot clearinghouse state (spot balance) of the recipient. You can also use the Hyperliquid API retrieve the [perps balances](https://hyperliquid.gitbook.io/hyperliquid-docs/for-developers/api/info-endpoint/perpetuals#retrieve-users-perpetuals-account-summary) and [spot balances](https://hyperliquid.gitbook.io/hyperliquid-docs/for-developers/api/info-endpoint/spot#retrieve-a-users-token-balances).
  </Accordion>
</AccordionGroup>

## Reference Implementation

For a complete working example showing the full transfer to spot workflow including balance verification, see the [to-spot.spec.ts](https://github.com/LIT-Protocol/Vincent/blob/main/packages/apps/ability-hyperliquid/test/e2e/transfer/to-spot.spec.ts) end-to-end test in the `ability-hyperliquid` package.

## Next Steps

Explore the rest of the supported Hyperliquid actions:

<CardGroup cols={3}>

<Card title="Deposit" href="/ability/official-abilities/hyperliquid/deposit" icon="arrow-down" />

<Card title="Withdraw" href="/ability/official-abilities/hyperliquid/withdraw" icon="arrow-up" />

<Card
  title="Send Spot Asset"
  href="/ability/official-abilities/hyperliquid/send-spot-asset"
  icon="coins"
/>

<Card
  title="Send Perp USDC"
  href="/ability/official-abilities/hyperliquid/send-perp-usdc"
  icon="dollar-sign"
/>

<Card
  title="Transfer to Perp"
  href="/ability/official-abilities/hyperliquid/transfer-to-perp"
  icon="arrow-left"
/>

<Card
  title="Spot Buy"
  href="/ability/official-abilities/hyperliquid/spot-buy"
  icon="shopping-cart"
/>

<Card title="Spot Sell" href="/ability/official-abilities/hyperliquid/spot-sell" icon="tag" />

<Card
  title="Perp Long"
  href="/ability/official-abilities/hyperliquid/perp-long"
  icon="arrow-up-right"
/>

<Card
  title="Perp Short"
  href="/ability/official-abilities/hyperliquid/perp-short"
  icon="arrow-down-right"
/>

<Card title="Cancel Order" href="/ability/official-abilities/hyperliquid/cancel-order" icon="ban" />

<Card
  title="Cancel All Orders"
  href="/ability/official-abilities/hyperliquid/cancel-all-orders-for-symbol"
  icon="trash"
/>

</CardGroup>
