---
title: 'EOA Integration'
---

This guide demonstrates how to integrate Vincent with traditional Externally Owned Accounts (EOAs) using the Aave ability as an example. You'll learn how to set up PKP delegation, prepare transactions, validate and sign them with Vincent abilities, and broadcast them directly to the network without a bundler.

<CardGroup cols={2}>
  <Card title="Source Repository" icon="github" href="https://github.com/LIT-Protocol/vincent-smart-account-signer" color="#FF4205">
    View the complete example repository
  </Card>
  <Card title="eoaIntegration.ts" icon="code" href="https://github.com/LIT-Protocol/vincent-smart-account-signer/blob/main/src/eoaIntegration.ts" color="#FF4205">
    View the complete implementation file
  </Card>
</CardGroup>

## Prerequisites

**Vincent Setup**: Follow [Creating an App](/app/creating-an-app) to obtain your Vincent App ID, Delegatee Private Key, and PKP ETH Address.

Set the following environment variables:

- **ALCHEMY_RPC_URL**: Endpoint for transaction simulation from [Alchemy](https://www.alchemy.com/)
- **VINCENT_APP_ID**: Your Vincent application identifier
- **DELEGATEE_PRIVATE_KEY**: Private key for Vincent ability delegation
- **PKP_ETH_ADDRESS**: Your Programmable Key Pair Ethereum address

## Complete Integration Flow

### Step 1: Setup Delegation

```typescript
import { setupVincentDelegation } from './utils/setupVincentDelegation';

const pkpEthAddress = await setupVincentDelegation({
  ownerAccount,
  vincentAppId,
});
```

**What this does:**
Sets up Vincent PKP delegation. The PKP address will sign transactions directly.

### Step 2: Fund PKP Address

```typescript
import { fundAccount } from './utils/fundAccount';
import { parseUnits } from 'viem';

await fundAccount({
  accountAddress: pkpEthAddress as Address,
  // EOAs need native currency to pay gas
  nativeFunds: parseUnits('0.0001', 18),
});
```

**Critical:** EOAs must pay gas fees directly, so the PKP address needs native currency.

**What this does:**
Transfers native currency to the PKP address for gas fees.

<AccordionGroup>
  <Accordion title="View fundAccount.ts">
    ```typescript
    export async function fundAccount({
      accountAddress,
      nativeFunds = 0n,
    }: FundAccountParams) {
      if (nativeFunds > 0n) {
        const nativeTx = await fundsProviderWalletClient.sendTransaction({
          chain,
          account: fundsProviderWalletClient.account!,
          to: accountAddress,
          value: nativeFunds,
        });

        await publicClient.waitForTransactionReceipt({
          confirmations: 2,
          hash: nativeTx,
        });

        console.log(
          `Funded ${accountAddress} with ${nativeFunds} wei of native currency`
        );
      }
    }
    ```
  </Accordion>
</AccordionGroup>

### Step 3: Generate Transactions

```typescript
import { generateTransactions } from './utils/generateTransactions';

const transactions = await generateTransactions({
  accountAddress: pkpEthAddress as Address,
});
```

**What this does:**
Generates Aave transactions (approve, supply, withdraw) based on account state.

### Step 4: Process Each Transaction

EOAs process transactions sequentially in a loop:

```typescript
import { toVincentTransaction } from '@lit-protocol/vincent-ability-aave-smart-account';
import { parseSignature, serializeTransaction } from 'viem';

const vincentDelegationContext = {
  delegatorPkpEthAddress: pkpEthAddress,
};

for (const transaction of transactions) {
  // 4a. Prepare transaction request
  const transactionRequest = await publicClient.prepareTransactionRequest({
    account: pkpEthAddress,
    from: pkpEthAddress,
    data: transaction.data,
    to: transaction.to,
    value: BigInt(transaction.value),
  });

  // 4b. Validate with Vincent
  const vincentAbilityParams = {
    alchemyRpcUrl: alchemyRpc,
    transaction: toVincentTransaction(transactionRequest),
  };

  const precheckResult = await abilityClient.precheck(
    vincentAbilityParams,
    vincentDelegationContext
  );
  if (!precheckResult.success) {
    throw new Error(`Precheck failed`);
  }

  // 4c. Execute and sign
  const executeResult = await abilityClient.execute(
    vincentAbilityParams,
    vincentDelegationContext
  );
  if (!executeResult.success) {
    throw new Error(`Execute failed`);
  }

  // 4d. Serialize transaction with signature
  const signature = executeResult.result.signature as Hex;
  const serializedTransaction = serializeTransaction(
    transactionRequest as any,
    parseSignature(signature)
  );

  // 4e. Broadcast
  const txHash = await publicClient.sendRawTransaction({
    serializedTransaction,
  });

  await publicClient.waitForTransactionReceipt({
    confirmations: 2,
    hash: txHash,
  });
}
```

**Step breakdown:**

**4a. Prepare Transaction Request**
- Uses viem's `prepareTransactionRequest()` to populate gas, nonce, etc.
- Sets `from` and `account` to PKP address

**4b. Convert and Validate**
- Uses `toVincentTransaction()` (not `toVincentUserOp()`)
- No `entryPointAddress` parameter needed
- Precheck validates without signing

**4c. Execute and Sign**
- Same validation as precheck
- Signs with Vincent PKP
- Returns raw signature

**4d. Serialize Transaction**
- `parseSignature()` converts hex signature to r, s, v components
- `serializeTransaction()` creates RLP-encoded signed transaction

**4e. Broadcast**
- `sendRawTransaction()` broadcasts to network
- No bundler needed - standard Ethereum transaction

### Step 5: Cleanup

```typescript
import { disconnectVincentAbilityClients } from '@lit-protocol/vincent-app-sdk/abilityClient';

await disconnectVincentAbilityClients();
```

## Complete Example

<Card title="eoaIntegration.ts" icon="github" href="https://github.com/LIT-Protocol/vincent-smart-account-signer/blob/main/src/eoaIntegration.ts" color="#FF4205">
  View the complete implementation on GitHub
</Card>
